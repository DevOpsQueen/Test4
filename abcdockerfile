# Use the official Tomcat 9 image as the base image
FROM tomcat:10

# Set the environment variables
ENV TOMCAT_USER=juju1
ENV TOMCAT_PASSWORD=password
ENV WAR_FILE=ABCTechnologies.war

# Copy the war file to the webapps directory
COPY /var/lib/jenkins/workspace/Test5/ABCTechnologies/target/${WAR_FILE} opt/tomcat/webapps/

# Add a script to automatically deploy the war file when the container starts
ADD deploy.sh /usr/local/tomcat/bin/
RUN chmod +x /usr/local/tomcat/bin/deploy.sh

# Expose the Tomcat port
EXPOSE 8888

# Start Tomcat and deploy the war file
CMD ["/usr/local/tomcat/bin/deploy.sh"]
